market: cn

data:
  start_years: 5
  end_date: "today"
  cache_dir: "cache"
  cache_tag: null
  cache_mode: "symbol"
  cache_refresh_days: 10
  cache_refresh_on_hit: false
  price_col: "close"
  retry:
    max_attempts: 1
    backoff_seconds: 0.5
    max_backoff_seconds: 5.0
    rotate_tokens: true

fundamentals:
  enabled: true
  source: "provider"
  file: null
  endpoint: "daily_basic"
  fields: "ts_code,trade_date,total_mv,pe_ttm,pb"
  symbol_param: "ts_code"
  start_param: "start_date"
  end_param: "end_date"
  params: {}
  column_map:
    trade_date: trade_date
    ts_code: ts_code
    market_cap: total_mv
    pe_ttm: pe_ttm
    pb: pb
  features:
    - market_cap
    - pe_ttm
    - pb
    - log_mcap
  auto_add_features: true
  allow_missing_features: true
  required: false
  ffill: true
  ffill_limit: null
  log_market_cap: true
  market_cap_col: "market_cap"
  log_market_cap_col: "log_mcap"

universe:
  mode: "static"
  require_by_date: false
  symbols:
    - "600519.SH"
    - "601318.SH"
    - "600036.SH"
    - "000858.SZ"
    - "000333.SZ"
    - "600887.SH"
    - "600276.SH"
    - "601888.SH"
    - "000001.SZ"
    - "002415.SZ"
  symbols_file: null
  by_date_file: null
  min_symbols_per_date: 5
  min_listed_days: 0
  min_turnover: 0
  drop_st: false
  drop_suspended: true
  suspended_policy: "mark"

label:
  horizon_mode: "next_rebalance"
  rebalance_frequency: "M"
  horizon_days: 20
  shift_days: 1
  target_col: "future_return"
  winsorize_pct: null

features:
  list:
    - sma_20
    - sma_5_diff
    - sma_10_diff
    - sma_20_diff
    - rsi_14
    - macd_hist
    - volume_sma5_ratio
    - vol
  params:
    sma_windows: [5, 10, 20]
    rsi: 14
    macd: [12, 26, 9]
    volume_sma_windows: [5]
  cross_sectional:
    method: "zscore"
    winsorize_pct: null

model:
  type: xgb_regressor
  params:
    n_estimators: 300
    learning_rate: 0.05
    max_depth: 3
    subsample: 0.8
    colsample_bytree: 0.8
    reg_alpha: 0.0
    reg_lambda: 1.0
    objective: "reg:squarederror"
    random_state: 42
  sample_weight_mode: "date_equal"

eval:
  test_size: 0.2
  n_splits: 5
  n_quantiles: 5
  rebalance_frequency: "M"
  top_k: 5
  signal_direction: 1
  signal_direction_mode: "cv_ic"
  min_abs_ic_to_flip: 0.002
  transaction_cost_bps: 10
  buffer_exit: 2
  buffer_entry: 1
  sample_on_rebalance_dates: true
  embargo_days: null
  purge_days: null
  report_train_ic: true
  save_artifacts: true
  output_dir: "out/runs"
  run_name: null
  permutation_test:
    enabled: false
    n_runs: 3
    seed: 42
  walk_forward:
    enabled: true
    n_windows: 3
    test_size: null
    step_size: null
    anchor_end: true
    backtest_enabled: true
    permutation_test:
      enabled: false
      n_runs: 3
      seed: 42

backtest:
  enabled: true
  top_k: 5
  rebalance_frequency: "M"
  transaction_cost_bps: 10
  trading_days_per_year: 252
  long_only: true
  short_k: null
  benchmark_symbol: null
  exit_mode: "rebalance"
  exit_horizon_days: null
  buffer_exit: 2
  buffer_entry: 1
  exit_price_policy: "delay"
  exit_fallback_policy: "ffill"
